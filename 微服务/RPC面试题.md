## 1.RPC原理

**RPC（Remote Procedure Call）** 即远程过程调用，两个不同的服务器上的服务提供的方法不在一个内存空间，所以，需要通过网络编程才能传递方法调用所需要的参数。通过 RPC 可以帮助我们调用远程计算机上某个服务的方法，这个过程就像调用本地方法一样简单。

原理如下：

**客户端（服务消费端）**：调用远程方法的一端。

**客户端 Stub（桩）**：这其实就是一代理类。代理类主要做的事情很简单，就是把你调用方法、类、方法参数等信息传递到服务端。

**网络传输**：网络传输就是你要把你调用的方法的信息比如说参数啊这些东西传输到服务端，然后服务端执行完之后再把返回结果通过网络传输给你传输回来。网络传输的实现方式有很多种比如最基本的 Socket 或者性能以及封装更加优秀的 Netty（推荐）。

**服务端 Stub（桩）**：这个桩就不是代理类了。我觉得理解为桩实际不太好，大家注意一下就好。这里的服务端 Stub 实际指的就是接收到客户端执行方法的请求后，去执行对应的方法然后返回结果给客户端的类。

**服务端（服务提供端）**：提供远程方法的一端。

## 2.选用Dubbo

gRPC 和 Thrift 虽然支持跨语言的 RPC 调用，但是它们只提供了最基本的 RPC 框架功能，缺乏一系列配套的服务化组件和服务治理功能的支撑。

Dubbo 不论是从功能完善程度、生态系统还是社区活跃度来说都是最优秀的，提供了从服务定义、服务发现、服务通信到流量管控等几乎所有的服务治理能力

## 3.rpc和http区别

**socket网络通信：**

​	封装了 IP 地址和端口号，用于标识网络中的唯一进程。

**流式Socket：**

- 基于 TCP 协议，提供可靠的、面向连接的通信。

- 数据以字节流的形式传输，保证数据的顺序和完整性。

**数据报Socket：**

- 基于 UDP 协议，提供不可靠的、无连接的通信。
- 数据以数据包的形式传输，不保证顺序和完整性。

**服务端绑定的IP地址：**

​	**0.0.0.0：**

- 客户端可以通过服务器的 **本地 IP 地址** 或 **公网 IP 地址** 连接到服务器。

   **127.0.0.1:**

- 表示绑定到 **本地回环地址**（Loopback Address），仅允许本地客户端连接。
- 客户端只能通过 `127.0.0.1` 或 `localhost` 连接到服务器。

**具体 IP 地址**：

- 表示绑定到指定的网络接口（如本地 IP 或公网 IP）。
- 客户端只能通过该 IP 地址连接到服务器。

**TCP 是传输层的协议** ，而基于 TCP 造出来的 HTTP 和各类 RPC 协议，它们都只是定义了不同消息格式的 **应用层协议** 而已。

 **HTTP**协议又叫做 **超文本传输协议** 。我们用的比较多，平时上网在浏览器上敲个网址就能访问网页，这里用到的就是 HTTP 协议。

 **RPC**又叫做 **远程过程调用**，它本身并不是一个具体的协议，而是一种 **调用方式** 。

### 主要区别：

- 服务发现：

  在 **HTTP** 中，你知道服务的域名，就可以通过 **DNS 服务** 去解析得到它背后的 IP 地址，默认 **80 端口**。

  而 **RPC** 的话，就有些区别，一般会有专门的中间服务去保存服务名和 IP 信息，比如 **Consul、Etcd、Nacos、ZooKeeper，甚至是 Redis**。想要访问某个服务，就去这些中间服务去获得 IP 和端口信息。

- 底层连接形式：

  **HTTP1.1** 协议为例，其默认在建立底层 TCP 连接之后会一直保持这个连接（**keep alive**），之后的请求和响应都会复用这条连接。

  **RPC** 协议，也跟 HTTP 类似，也是通过建立 TCP 长链接进行数据交互，但不同的地方在于，RPC 协议一般还会再建个 **连接池**，在请求量大的时候，建立多条连接放在池内，要发数据的时候就从池里取一条连接出来，用完放回去，下次再复用

- 传输的内容：

  基于 TCP 传输的消息，说到底，无非都是 **消息头 Header 和消息体 Body。**

   **HTTP1.1**，虽然它现在叫超文本协议，支持音频视频，但 HTTP 设计 初是用于做网页文本展示的，所以它传的内容以字符串为主。Header 和 Body 都是如此。在 Body 这块，它使用 **JSON** 来 **序列化** 结构体数据。

![](D:\学习笔记\微服务\pictures\Snipaste_2025-03-24_20-39-00.png)

​	**RPC**，因为它定制化程度更高，可以采用体积更小的 Protobuf 或其他序列化协议去保存结构体数据，