#### Redis数据库结构是以dict数据结构存储的![](D:\学习笔记\java\pictures\Snipaste_2023-12-26_16-38-24.png)

dict是数据字典，expires是过期字典，这里dict和expires中的key对象实际都是String对象的指针，并不是重复占用的内容

#### Redis是单线程还是多线程

Redis的核心执行流程是单线程

![](D:\学习笔记\java\pictures\Snipaste_2023-12-26_17-02-10.png)

**为什么选择单线程：**多线程复杂，成本高，上下文切换，保存本地数据、程序指针等；一些公共资源为了保证同步需要加锁；一个线程本身也占用内存

**为什么单线程还这么快：**1.是内存数据库 2.选择了高效数据结构 3.多路复用机制，使其在网络IO操作可以并发处理大量客户端请求，实现高吞吐量



#### 内存淘汰

不开启的话：写入数据会失败

![](D:\学习笔记\java\pictures\Snipaste_2023-12-26_17-09-19.png)

内存回收的时机：每次进行读写的时候都会检查是否需要释放内存

LRU：记录每个key最近访问时间，但是Redis使用的是近似LRU：![](D:\学习笔记\java\pictures\Snipaste_2023-12-26_17-24-24.png)

LFU记录了上一次访问的时间戳和访问计数，访问计数表示活性大小，**因为访问计数也会受访问时间和访问频率的影响，会增加也会减少**，每次访问都**可能**增加访问计数。



