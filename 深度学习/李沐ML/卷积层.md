### 卷积层

设输入大小为nh*nw

卷积核大小为kh*kw

输出大小为(nh-kn+1)*(nw-kw+1)

卷积层的作用：

1.将输入和核矩阵进行交叉相关，加上偏移后得到输出

2.核矩阵和偏移是可学习的参数

3.核矩阵的大小是超参数

```python
conv2d = nn.Conv2d(1,1, kernel_size=(1, 2), bias=False)
# 这个二维卷积层使用四维输入和输出格式（批量大小、通道、高度、宽度）
nn.Conv2d(3, 32, 5, 1, 2), # 3通道，32个卷积核，卷积核大小为5*5，步长为1，padding为2
```

#### 1.填充和步幅（均为卷积层的超参数）

##### 填充

![](D:\学习笔记\深度学习\L\Snipaste_2023-11-26_15-01-06.png)

填充可以保证输出图像大小不变

##### 步幅

![](D:\学习笔记\深度学习\L\Snipaste_2023-11-26_15-07-06.png)

给定高度sh和宽度sw的步幅，则图像输出大小为：

![](D:\学习笔记\深度学习\L\Snipaste_2023-11-26_15-10-11.png)

```python
#输入大小为8*8
conv2d = nn.Conv2d(1, 1, kernel_size=(3, 5), padding=(0, 1), stride=(3, 4))
输出：
宽度：(8-3+3)/3 下取整：2
高度：(8-5+1*2+4)/4=2
conv2d = nn.Conv2d(1, 1, kernel_size=(5, 3), padding=(2, 1)) # 上下各填充2行，左右各填充1列
输出：
宽度：(8-5+4+1)=8
高度：(8-3+2+1)=8
```

#### 2.多输入和输出通道

有多个输入通道时（以两个通道为例）只有单输出通道

![](D:\学习笔记\深度学习\L\Snipaste_2023-11-26_15-39-15.png)

生成多输出通道

可以有多个三维卷积核，每个核生成一个输出通道

![](D:\学习笔记\深度学习\L\Snipaste_2023-11-26_16-34-59.png)

Co为输出通道数

![](D:\学习笔记\深度学习\L\Snipaste_2023-11-26_16-47-02.png)

```
如何理解相当于输入形状为nhnw*ci 权重为ci*co的全连接层？
相当于把三个输入通道看成features，输出通道的kernel的ci为对应feature的权重，co为输出的features
```

